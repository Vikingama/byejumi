<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>module load</title>
    </head>

    <body>
        ES6 模块与 CommonJS 模块的差异：
        <ul>
            <li>
                CommonJS
                模块输出的是一个值的拷贝（一旦输出一个值，模块内部的变化就影响不到这个值），ES6
                模块输出的是值的引用...
            </li>
            <li>
                CommonJS 模块是运行时加载，ES6 模块是编译时输出接口...
            </li>
            <li>
                ES6
                模块不会缓存运行结果，而是动态地去被加载的模块取值，并且变量(只读)总是绑定其所在的模块...
            </li>
            <li>
                ES6 模块之中，顶层的 this 指向 undefined；CommonJS 模块的顶层
                this 指向当前模块...
            </li>
            <li>
                export
                通过接口，输出的是同一个值。不同的脚本加载这个接口，得到的都是同样的实例...
            </li>
        </ul>
        <hr />
        Node 加载：
        <ul>
            <li>
                Node 有自己的 CommonJS 模块格式，与 ES6 模块格式是不兼容的。ES6
                模块和 CommonJS 采用各自的加载方案...
            </li>
            <li>
                Node 要求 ES6 模块采用 .mjs 后缀文件名。只要脚本文件里面使用
                import 或者 export 命令，那么就必须采用 .mjs 后缀名...
            </li>
            <li>
                require 命令不能加载 .mjs 文件，会报错，只有 import
                命令才可以加载 .mjs 文件。.mjs 文件里面也不能使用 require
                命令，必须使用 import...
            </li>
            <li>
                脚本路径带有参数 ?query=1，Node 会按 URL
                规则解读。同一个脚本只要参数不同，就会被加载多次，并且保存成不同的缓存。只要文件名中含有
                :、%、#、? 等特殊字符，最好对这些字符进行转义...
            </li>
            <li>
                Node 的 import 命令只支持加载本地模块，不支持加载远程模块...
            </li>
            <li>
                Node 的 import 命令是异步加载，这一点与浏览器的处理方法相同...
            </li>
        </ul>
    </body>
    <script async>
        /*
        下载完就执行...
        async 一旦下载完，渲染引擎就会中断渲染，执行这个脚本以后，再继续渲染...
        */
    </script>
    <script defer>
        /*
        渲染完就执行...
        defer 要等到整个页面在内存中正常渲染结束（DOM 结构完全生成，其他脚本执行完成），才会执行...
        <script type="module" src="./foo.js">
        <!-- 等同于 -->
        <script type="module" src="./foo.js" defer>
        */
        `
        // ES6 模块加载 CommonJS 模块：
        module.exports = {
            foo: "foo",
            bar: "bar"
        }
        <==>
        export default {
            foo: "foo",
            bar: "bar"
        }
        `;
    </script>
</html>
